<style type="text/css">
  .work {
  padding-bottom: 40px;
  margin-top:60px;

  $active: #373B3D;
  $inactive: #9A9A9A;
  
  *{
    box-sizing:border-box;
  }

  .category-buttons {
    text-align:center;
    margin:0 0 60px 0;
    
    @media(max-width: 610px) {
      margin:0 0 30px 0;
      
      a {
        display:inline-block;
        width:46%;
        padding: 12px 10px!important;
        margin:1.5% 1%!important;
      }
      a:nth-child(even) {
        margin-right:0;
      }
      a:nth-child(odd) {
        margin-left:0;
      }
    }
    @media(min-width: 611px) {
      a:first-child {
        margin-left:0;
      }
      a:last-child {
        margin-right:0;
      }
    }
    a {
      color:$inactive;
      text-decoration:none;
      padding: 9px 15px;
      border:1px solid $inactive;
      margin:0 10px;
      cursor: pointer;
    }
    a.active {
      color:$active;
      border: 1px solid $active;
    }
  }
  .grid {
    margin-top:40px;
    width:100%;
    max-width:960px;
    //background:#f2f2f2;
    margin:0 auto;
    position:relative;
    -webkit-transition: all 750ms cubic-bezier(1, 0, 0, 1);
      transition:all 750ms cubic-bezier(1, 0, 0, 1);
   
    @media (max-width: 960px) {
      width:700px;
    }
    
    @media (max-width: 720px) {
      width:100%;
    }
    .animating {
      -webkit-transition: all 750ms cubic-bezier(0.175, 0.885, 0.32, 1.1);
      transition:all 750ms cubic-bezier(0.175, 0.885, 0.32, 1.1);
    }
    .setScale {
      -webkit-transform:scale(1);
      -ms-transform: scale(1);
      transform: scale(1);
    }
    .show {
      -webkit-transform:scale(1);
      -ms-transform: scale(1);
      transform: scale(1);
      opacity: 1;
    }
  }
  .card {
    background:#fff;
    display:block;
    text-decoration:none;
    color:#2b2b2b;
    width: 32%;
    box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1), 0 1px 5px rgba(0, 0, 0, 0.15);
    transform-origin: center center;
    -webkit-transform: translateZ(0);
    -moz-transform: translateZ(0);
    -ms-transform: translateZ(0);
    -o-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-transform:scale(0);
    -ms-transform: scale(0);
    transform: scale(0);
    opacity: 0;
    @media (max-width: 960px) {
    }
    
    @media (max-width: 700px) {
      width:49.25%;
    }
    
    @media (max-width: 480px) {
      width:100%;
    }
    
    img {
      display:block;
      width:100%;
    }
    
    .title {
     padding:10px; 
      color:#2b2b2b;
    }
  }
  .guide {
    width: 32%;
    position:absolute;
    left:0;
    top:0;
    z-index: -1000;
    
     @media (max-width: 700px) {
      width:49.25%;
    }
    
    @media (max-width: 480px) {
      width:100%;
    }
  }
}

</style>


<div class="work">
  <div class="category-buttons">
    <a href="#" class="active all" data-group="all">All</a>
    <a href="#" data-group="city">city</a>
    <a href="#" data-group="nature">nature</a>
    <a href="#" data-group="food">food</a>
    <a href="#" data-group="sports">sports</a>
    <a href="#" data-group="people">people</a>
  </div>

  <div id="grid" class="grid">
    <a class="card" href="#" data-groups="city,">
      <img src="hcom/200/150/city" />
      <div class="title">Project Title test me more please do this for me please dood.</div>
    </a>
    <a class="card" href="#" data-groups="nature,">
      <img src="hcom/200/150/nature" />
      <div class="title">Project Title</div>
    </a>
    <a class="card" href="#" data-groups="food,">
      <img src="hcom/200/150/food" />
      <div class="title">Project Title</div>
    </a>
    <a class="card" href="#" data-groups="sports,people,">
      <img src="hcom/200/150/sports" />
      <div class="title">Project Title</div>
    </a>
    <a class="card" href="#" data-groups="people,food,">
      <img src="hcom/200/150/people" />
      <div class="title">Project Title</div>
    </a>
    <a class="card" href="#" data-groups="city,people,">
      <img src="hcom/200/150/city/2" />
      <div class="title">Project Title wow this is so sext</div>
    </a>
    <a class="card" href="#" data-groups="nature,food,">
      <img src="hcom/200/150/nature/2" />
      <div class="title">Project Title</div>
    </a>
    <a class="card" href="#" data-groups="food,people,">
      <img src="hcom/200/150/food/2" />
      <div class="title">Project Title test me please dood wow this could be better</div>
    </a>
    <a class="card" href="#" data-groups="sports,people,">
      <img src="hcom/200/150/sports/2" />
      <div class="title">Project Title</div>
    </a>
    <a class="card" href="#" data-groups="people,food">
      <img src="hcom/200/150/people/2" />
      <div class="title">Project Title</div>
    </a>
    <div class="guide"></div>
  </div>
</div>
<script src="https://code.jquery.com/jquery-compat-git.js"></script>


<script type="text/javascript">
  $(document).ready(function() {
  var projects = $('.card');
  var filteredProjects = [];
  var selection = "all";
  var running = false;
  window.setTimeout(function() {
    $('.all').trigger('click');
  }, 150);

  $(window).resize(function() {
    buildGrid(filteredProjects);
  });

  $('.category-buttons a').on('click', function(e) {
    e.preventDefault();
    if (!running) {
      running = true;
      selection = $(this).data('group');
      $('.category-buttons a').removeClass('active');
      $(this).addClass('active');
      filteredProjects = [];
      for (i = 0; i < projects.length; i++) {
        var project = projects[i];
        var dataString = $(project).data('groups');
        var dataArray = dataString.split(',');
        dataArray.pop();
        if (selection === 'all') {
          $(project).addClass('setScale').queue(function(next) {
            filteredProjects.push(project);
            next();
          }).queue(function(next) {
            $(this).removeClass('setScale');
            next();
          }).queue(function(next) {
            $(this).addClass('animating show')
            next();
          }).delay(750).queue(function() {
            running = false;
            $(this).removeClass('animating').dequeue();
          });
        } else {
          if ($.inArray(selection, dataArray) > -1) {
            $(project).addClass('setScale').queue(function(next) {
              filteredProjects.push(project);
              next();
            }).queue(function(next) {
              $(this).removeClass('setScale');
              next();
            }).queue(function(next) {
              $(this).addClass('animating show')
              next();
            }).delay(750).queue(function() {
              running = false;
              $(this).removeClass('animating').dequeue();
            });
            /*$(project).css({
              '-webkit-transition': 'all 750ms cubic-bezier(0.175, 0.885, 0.32, 1.1)',
              'transition': 'all 750ms cubic-bezier(0.175, 0.885, 0.32, 1.1);',
              '-webkit-transform': 'scale(' + 1 + ')',
              '-ms-transform': 'scale(' + 1 + ')',
              'transform': 'scale(' + 1 + ')',
              'opacity': 1
            });*/
          } else {
            $(project).queue(function(next) {
              $(this).addClass('animating');
              next();
            }).queue(function(next) {
              $(this).removeClass('show');
              next();
            }).delay(750).queue(function() {
              $(this).removeClass('animating').dequeue();
            });

            /*$(project).css({
              '-webkit-transition': 'all 750ms cubic-bezier(0.175, 0.885, 0.32, 1.1)',
              'transition': 'all 750ms cubic-bezier(0.175, 0.885, 0.32, 1.1);',
              '-webkit-transform': 'scale(' + 0 + ')',
              '-webkit-transform': 'scale(' + 0 + ')',
              '-ms-transform': 'scale(' + 0 + ')',
              'transform': 'scale(' + 0 + ')',
              'opacity': 0
            });*/
          }
        }
      }
      buildGrid(filteredProjects);
    }
  })

  function buildGrid(projects) {
    var left = 0;
    var top = 0;
    var totalHeight = 0;
    var largest = 0;
    var heights = [];
    for (i = 0; i < projects.length; i++) {
      $(projects[i]).css({
        height: 'auto'
      });
      heights.push($(projects[i]).height());
    }
    var maxIndex = 0;
    var maxHeight = 0;

    for (i = 0; i <= heights.length; i++) {
      if (heights[i] > maxHeight) {
        maxHeight = heights[i];
        maxIndex = i;
        $('.guide').height(maxHeight);
      }
      if (i === heights.length) {
        for (i = 0; i < projects.length; i++) {
          $(projects[i]).css({
            position: 'absolute',
            left: left + '%',
            top: top
          });
          left = left + ($('.guide').width() / $('#grid').width() * 100) + 2;

          if (i === maxIndex) {
            $(projects[i]).css({
              height: 'auto'
            });
          } else {
            $(projects[i]).css({
              height: maxHeight
            });
          }
          if ((i + 1) % 3 === 0 && projects.length > 3 && $(window).width() >= 700) {
            top = top + $('.guide').height() + 20;
            left = 0;
            totalHeight = totalHeight + $('.guide').height() + 20;

          } else if ((i + 1) % 2 === 0 && projects.length > 2 && $(window).width() < 700 && $(window).width() >= 480) {
            top = top + $('.guide').height() + 20;
            left = 0;
            totalHeight = totalHeight + $('.guide').height() + 20;

          } else if ((i + 1) % 1 === 0 && projects.length > 1 && $(window).width() < 480) {
            top = top + $('.guide').height() + 20;
            left = 0;
            totalHeight = totalHeight + $('.guide').height() + 20;
          }
          $('#grid').height(totalHeight + $('.guide').height());
        }
      }
    }
  }
})
</script>